# registry_bench
Benchmark for Erlang global registry

# Usage

````
#./run-test.sh 5 1000 false
````

Аргументы:
- 5 - количество нод эрланг в кластере
- false - флаг, определяющий конфликтность/бесконфликтность имён процессов. Если true, то все ноды будут использовать 
единое пространство имен, если false, то ноды будут использовать непересекающиеся имена
- 1000 - количество процессов. Важно: эффект от значения этого параметра зависит от флага конфликтности. Если флаг true,
то этот параметр определяет общее количество процессов, которое будет запущено/зарегистрировано глобально на всём кластере.
Если флаг false, то этот параметр задает количество процессов для каждой ноды. Пример: для сравнения производительности 
регистрации в кластере 5000 процессов при бесконфликтной регистрации необходимо выполнить команду:
````
#./run-test.sh 5 1000 false
````
а при конфликтной:
````
#./run-test.sh 5 5000 true
````

Результат теста сохраняется в файл report.json. Пример:
````
#./run-test.sh 5 1000 true
# cat report.json | jq .
[
  {
    "fail": 851,
    "node": "3@nix.yapp.zone",
    "success": 149,
    "time": 5839259,
    "total": 1000
  },
  {
    "fail": 902,
    "node": "4@nix.yapp.zone",
    "success": 98,
    "time": 4142882,
    "total": 1000
  },
  {
    "fail": 496,
    "node": "2@nix.yapp.zone",
    "success": 504,
    "time": 2587557,
    "total": 1000
  },
  {
    "fail": 1000,
    "node": "1@nix.yapp.zone",
    "success": 0,
    "time": 2082540,
    "total": 1000
  },
  {
    "fail": 751,
    "node": "5@nix.yapp.zone",
    "success": 249,
    "time": 1126161,
    "total": 1000
  }
]
````

Здесь:
- node - имя ноды
- success - количество успешно зарегистрированных процессов
- fail - количество неудачных регистраций
- total - всего глобально зарегистрированных процессов, которые "видит" нода после завершения теста
- time - время, затраченное нодой на запуск (spawn) и регистрацию процессов в микросекундах
